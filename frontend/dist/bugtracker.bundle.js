!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.BugTracker=e():t.BugTracker=e()}(Object("undefined"!=typeof self?self:this),()=>(()=>{"use strict";var t,e,s,n,i={},r={};function o(t){var e=r[t];if(void 0!==e)return e.exports;var s=r[t]={exports:{}};return i[t].call(s.exports,s,s.exports,o),s.exports}o.m=i,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,o.t=function(s,n){if(1&n&&(s=this(s)),8&n)return s;if("object"==typeof s&&s){if(4&n&&s.__esModule)return s;if(16&n&&"function"==typeof s.then)return s}var i=Object.create(null);o.r(i);var r={};t=t||[null,e({}),e([]),e(e)];for(var a=2&n&&s;("object"==typeof a||"function"==typeof a)&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach(t=>r[t]=()=>s[t]);return r.default=()=>s,o.d(i,r),i},o.d=(t,e)=>{for(var s in e)o.o(e,s)&&!o.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce((e,s)=>(o.f[s](t,e),e),[])),o.u=t=>t+".bugtracker.bundle.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s={},n="BugTracker:",o.l=(t,e,i,r)=>{if(s[t])s[t].push(e);else{var a,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==n+i){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",n+i),a.src=t),s[t]=[e];var h=(e,n)=>{a.onerror=a.onload=null,clearTimeout(g);var i=s[t];if(delete s[t],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach(t=>t(n)),e)return e(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;o.g.importScripts&&(t=o.g.location+"");var e=o.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");if(s.length)for(var n=s.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=s[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=t})(),(()=>{var t={792:0};o.f.j=(e,s)=>{var n=o.o(t,e)?t[e]:void 0;if(0!==n)if(n)s.push(n[2]);else{var i=new Promise((s,i)=>n=t[e]=[s,i]);s.push(n[2]=i);var r=o.p+o.u(e),a=new Error;o.l(r,s=>{if(o.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var i=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.src;a.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,n[1](a)}},"chunk-"+e,e)}};var e=(e,s)=>{var n,i,[r,a,l]=s,c=0;if(r.some(e=>0!==t[e])){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);l&&l(o)}for(e&&e(s);c<r.length;c++)i=r[c],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0},s=Object("undefined"!=typeof self?self:this).webpackChunkBugTracker=Object("undefined"!=typeof self?self:this).webpackChunkBugTracker||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var a,l={};o.r(l),o.d(l,{BugTracker:()=>P,default:()=>_,initialize:()=>M,isInitialized:()=>D,sendBugReport:()=>j,sendEvents:()=>R,sendEventsWithBeacon:()=>L}),function(t){t.ERROR="ERROR",t.ACTION="ACTION",t.NETWORK="NETWORK",t.PERFORMANCE="PERFORMANCE",t.CUSTOM="CUSTOM"}(a||(a={}));var c=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class u{constructor(t,e){this.baseUrl=t.replace(/\/$/,""),this.projectId=e}sendEvents(t,e,s){return c(this,void 0,void 0,function*(){var s,n,i,r,o,l,c,u,d,h,g;const m=Number(e);if(Number.isNaN(m))throw new Error("Session ID must be numeric to send events to backend");let f=null;for(const e of t){const t=(e.message||"")+(e.stackTrace?": "+e.stackTrace:""),p=""===t?"":t,v=null!==(n=null===(s=e.customMetadata)||void 0===s?void 0:s.eventLogId)&&void 0!==n?n:null===(i=e.customMetadata)||void 0===i?void 0:i.eventId;let b;if(e.type===a.ERROR)b=null!==(r=e.message)&&void 0!==r?r:p;else if(e.type===a.ACTION){const t=e.customMetadata||{};b=t.method||t.action?`form: ${null!==(o=t.method)&&void 0!==o?o:""} ${null!==(l=t.action)&&void 0!==l?l:""}`.trim():t.href?`link: ${t.href}`:null!=v?v:p}else b=null!=v?v:p;const y={sessionId:m,type:e.type,name:e.name,log:b,stackTrace:null!==(c=e.stackTrace)&&void 0!==c?c:"",url:null!==(u=e.url)&&void 0!==u?u:window.location.href,element:null!==(h=null!==(d=e.customMetadata&&(e.customMetadata.elementId||e.customMetadata.element))&&void 0!==d?d:e.tagName)&&void 0!==h?h:"",timestamp:new Date(e.timestamp).toISOString(),metadata:Object.assign({fileName:null!==(g=e.fileName)&&void 0!==g?g:"",lineNumber:e.lineNumber?String(e.lineNumber):"",statusCode:e.statusCode?String(e.statusCode):""},e.customMetadata||{})},w=yield fetch(`${this.baseUrl}/api/events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y),keepalive:!0});if(f=w,!w.ok)throw new Error(`HTTP ${w.status}: ${yield w.text()}`)}return{success:!0,message:"Events sent",data:{sessionId:e,receivedCount:t.length,timestamp:(new Date).toISOString()}}})}sendEventsWithBeacon(t,e,s){var n,i,r,o,l,c,u,d,h,g,m;const f=Number(e);if(Number.isNaN(f))return!1;try{for(const e of t){const t=null!==(i=null===(n=e.customMetadata)||void 0===n?void 0:n.eventLogId)&&void 0!==i?i:null===(r=e.customMetadata)||void 0===r?void 0:r.eventId,s=(e.message||"")+(e.stackTrace?": "+e.stackTrace:""),p=""===s?"":s;let v;if(e.type===a.ERROR)v=null!==(o=e.message)&&void 0!==o?o:p;else if(e.type===a.ACTION){const s=e.customMetadata||{};v=s.method||s.action?`form: ${null!==(l=s.method)&&void 0!==l?l:""} ${null!==(c=s.action)&&void 0!==c?c:""}`.trim():s.href?`link: ${s.href}`:null!=t?t:p}else v=null!=t?t:p;const b={sessionId:f,type:e.type,name:e.name,log:v,stackTrace:null!==(u=e.stackTrace)&&void 0!==u?u:"",url:null!==(d=e.url)&&void 0!==d?d:window.location.href,element:null!==(g=null!==(h=e.customMetadata&&(e.customMetadata.elementId||e.customMetadata.element))&&void 0!==h?h:e.tagName)&&void 0!==g?g:"",timestamp:new Date(e.timestamp).toISOString(),metadata:Object.assign({fileName:null!==(m=e.fileName)&&void 0!==m?m:"",lineNumber:e.lineNumber?String(e.lineNumber):"",statusCode:e.statusCode?String(e.statusCode):""},e.customMetadata||{})},y=new Blob([JSON.stringify(b)],{type:"application/json"});navigator.sendBeacon(`${this.baseUrl}/api/events`,y)}return!0}catch(t){return!1}}sendBugReport(t,e,s){return c(this,void 0,void 0,function*(){const s=Number(e);if(Number.isNaN(s))throw new Error("Session ID must be numeric to send bug reports to backend");const n={projectId:this.projectId,sessionId:s,title:t.comment?t.comment.substring(0,80):"User report",tags:[],reportedAt:(new Date).toISOString(),comments:t.comment,userEmail:t.email,screen:t.screenshot,currentUrl:window.location.href,userProvided:!0},i=yield fetch(`${this.baseUrl}/api/reports/widget`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!i.ok)throw new Error(`HTTP ${i.status}: ${yield i.text()}`);return{success:!0,message:(yield i.json()).message||"Report created",data:{sessionId:e,receivedCount:1,timestamp:(new Date).toISOString()}}})}sendSessionStart(t,e){return c(this,void 0,void 0,function*(){const t={projectId:this.projectId,startTime:e.startTime,browser:e.browser,browserVersion:e.browserVersion,os:e.os,deviceType:e.deviceType,screenResolution:e.screenResolution,viewportSize:e.viewportSize,language:e.language,userAgent:e.userAgent,ipAddress:e.ipAddress,cookiesHash:e.cookiesHash,plugins:e.plugins};try{const e=yield fetch(`${this.baseUrl}/api/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return e.ok?(yield e.json()).sessionId:null}catch(t){return null}})}}class d{constructor(){this.prefix="bt_"}set(t,e){try{const s=this.prefix+t,n=JSON.stringify(e);localStorage.setItem(s,n)}catch(t){console.warn("Failed to save to localStorage:",t)}}get(t){try{const e=this.prefix+t,s=localStorage.getItem(e);return s?JSON.parse(s):null}catch(t){return console.warn("Failed to read from localStorage:",t),null}}remove(t){try{const e=this.prefix+t;localStorage.removeItem(e)}catch(t){console.warn("Failed to remove from localStorage:",t)}}clear(){try{const t=[];for(let e=0;e<localStorage.length;e++){const s=localStorage.key(e);s&&s.startsWith(this.prefix)&&t.push(s)}t.forEach(t=>localStorage.removeItem(t))}catch(t){console.warn("Failed to clear localStorage:",t)}}setSession(t){this.set("session",t)}getSession(){return this.get("session")}updateLastActivity(){const t=this.getSession();t&&(t.lastActivity=Date.now(),this.setSession(t))}static isAvailable(){try{const t="__bt_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}}const h="bt_server_session";class g{constructor(t=18e5,e){this.sessionId=0,this.serverSessionId=null,this.sessionData=null,this.lastActivity=Date.now(),this.cleanupTimer=null,this.storage=new d,this.sessionTimeout=t,this.client=e;try{const t=localStorage.getItem(h);if(t){const e=Number(t);Number.isNaN(e)||(this.serverSessionId=e)}}catch(t){}}initialize(){const t=this.getExistingSession();return t&&!this.isSessionExpired(t)?(this.sessionId=t.id,this.sessionData=t.data,this.lastActivity=t.lastActivity,this.updateLastActivity(),this.startCleanupTimer(),!this.serverSessionId&&this.client&&this.createServerSession(this.sessionId,this.sessionData).catch(()=>{}),this.sessionId):this.createNewSession()}createNewSession(){return this.sessionId=-Date.now(),this.lastActivity=Date.now(),this.sessionData=this.collectSessionData(),this.sessionData.active=!0,this.storage.set("bt_session",{id:this.sessionId,startTime:this.lastActivity,lastActivity:this.lastActivity,data:this.sessionData}),this.setupCrossTabSync(),this.startCleanupTimer(),this.client&&this.createServerSession(this.sessionId,this.sessionData).catch(t=>{}),this.sessionId}createServerSession(t,e){return s=this,n=void 0,r=function*(){try{console.debug("[SessionManager] attempting to create server session for local id",t);const s=yield this.client.sendSessionStart(String(t),e);null===s||Number.isNaN(Number(s))?console.debug("[SessionManager] server session creation returned null (possibly invalid projectId or network error)"):(this.setServerSessionId(Number(s)),console.debug("[SessionManager] server session created:",this.serverSessionId),this.sessionData&&(this.sessionData.id=Number(s)))}catch(t){return void console.debug("[SessionManager] createServerSession failed:",t)}},new((i=void 0)||(i=Promise))(function(t,e){function o(t){try{l(r.next(t))}catch(t){e(t)}}function a(t){try{l(r.throw(t))}catch(t){e(t)}}function l(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i(function(t){t(s)})).then(o,a)}l((r=r.apply(s,n||[])).next())});var s,n,i,r}collectSessionData(){const t=function(){const t=navigator.userAgent;let e="Unknown",s="Unknown";const n=Array.from(navigator.plugins).map(t=>t.name);if(t.includes("Chrome")&&!t.includes("Edg")){const n=t.match(/Chrome\/(\d+\.\d+)/);e="Chrome",s=n?n[1]:"Unknown"}else if(t.includes("Firefox")){const n=t.match(/Firefox\/(\d+\.\d+)/);e="Firefox",s=n?n[1]:"Unknown"}else if(t.includes("Safari")&&!t.includes("Chrome")){const n=t.match(/Version\/(\d+\.\d+)/);e="Safari",s=n?n[1]:"Unknown"}else if(t.includes("Edg")){const n=t.match(/Edg\/(\d+\.\d+)/);e="Edge",s=n?n[1]:"Unknown"}return{name:e,version:s,plugins:n}}(),e=function(){const t=navigator.userAgent;let e="Unknown";return t.includes("Windows")?e="Windows":t.includes("Mac")?e="macOS":t.includes("Linux")?e="Linux":t.includes("Android")?e="Android":(t.includes("iOS")||t.includes("iPhone")||t.includes("iPad"))&&(e="iOS"),{name:e}}(),s=function(){const t=navigator.userAgent;let e="desktop";return/Mobile|Android|iPhone|iPad|iPod/i.test(t)&&(e="mobile",/iPad/i.test(t)&&(e="tablet")),{type:e}}(),n=function(){const t=navigator.connection;let e="unknown";return t&&(e=t.effectiveType||"unknown"),{type:e}}();return{id:this.sessionId,startTime:(new Date).toISOString(),lastActivity:(new Date).toISOString(),active:!0,browser:t.name,browserVersion:t.version,os:e.name,plugins:t.plugins,screenResolution:`${window.screen.width}x${window.screen.height}`,viewportSize:`${window.innerWidth}x${window.innerHeight}`,cookiesHash:this.hashCookies(document.cookie),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language,userAgent:navigator.userAgent,deviceType:s.type,connectionType:n.type,url:window.location.href,referrer:document.referrer}}hashCookies(t){let e=0;for(let s=0;s<t.length;s++)e=(e<<5)-e+t.charCodeAt(s),e&=e;return e.toString(36)}getExistingSession(){return this.storage.get("bt_session")}isSessionExpired(t){return Date.now()-t.lastActivity>this.sessionTimeout}updateLastActivity(){this.lastActivity=Date.now();const t=this.storage.get("bt_session");t&&(t.lastActivity=this.lastActivity,this.storage.set("bt_session",t)),this.resetCleanupTimer()}startCleanupTimer(){this.cleanupTimer&&clearInterval(this.cleanupTimer),this.cleanupTimer=window.setInterval(()=>{const t=this.getExistingSession();t&&this.isSessionExpired(t)&&(this.endSession(),this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null))},6e4)}resetCleanupTimer(){this.startCleanupTimer()}endSession(){try{this.storage.remove("bt_session")}catch(t){}this.sessionId=0,this.sessionData=null,this.serverSessionId=null;try{localStorage.removeItem(h)}catch(t){}this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}setupCrossTabSync(){window.addEventListener("storage",t=>{if("bt_session"===t.key&&t.newValue)try{const e=JSON.parse(t.newValue);e.startTime>this.lastActivity&&(this.sessionId=e.id,this.sessionData=e.data,this.lastActivity=e.lastActivity)}catch(t){}})}getSessionId(){var t;return null!==(t=this.serverSessionId)&&void 0!==t?t:this.sessionId}setServerSessionId(t){this.serverSessionId=Number(t);try{localStorage.setItem(h,String(this.serverSessionId))}catch(t){}this.sessionData&&(this.sessionData.id=Number(t))}isServerBacked(){return!!this.serverSessionId}getSessionData(){return this.sessionData||(console.warn("Session data accessed before initialization, creating now"),this.initialize()),this.sessionData}isActive(){return!!this.getSessionId()&&!this.isSessionExpired({lastActivity:this.lastActivity})}}class m{constructor(t,e){this.buffer=[],this.maxSize=t,this.onFlush=e}add(t){this.buffer.push(t),("ACTION"===t.type||"ERROR"===t.type)&&this.flush().catch(()=>{}),this.buffer.length>=this.maxSize&&this.flush().catch(()=>{})}flush(){return t=this,e=void 0,n=function*(){if(0===this.buffer.length)return;const t=[...this.buffer];this.buffer=[];try{yield this.onFlush(t)}catch(e){throw this.buffer=[...t,...this.buffer],e}},new((s=void 0)||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())});var t,e,s,n}getEvents(){return[...this.buffer]}clear(){this.buffer=[]}get size(){return this.buffer.length}isEmpty(){return 0===this.buffer.length}isFull(){return this.buffer.length>=this.maxSize}hasUrgentEvents(){return this.buffer.some(t=>"ACTION"===t.type||"ERROR"===t.type)}}function f(t){const e=`${t.name}:${t.message}:${t.stack||""}`;let s=0;for(let t=0;t<e.length;t++)s=(s<<5)-s+e.charCodeAt(t),s&=s;return Math.abs(s).toString(36)}class p{constructor(t){this.isCapturing=!1,this.originalConsoleError=null,this.ignoredErrors=[],this.onError=t}start(){this.isCapturing||(window.addEventListener("error",this.handleWindowError.bind(this)),window.addEventListener("unhandledrejection",this.handleUnhandledRejection.bind(this)),this.isCapturing=!0)}stop(){this.isCapturing&&(window.removeEventListener("error",this.handleWindowError),window.removeEventListener("unhandledrejection",this.handleUnhandledRejection),this.originalConsoleError&&(console.error=this.originalConsoleError,this.originalConsoleError=null),this.isCapturing=!1)}enableConsoleErrors(){this.originalConsoleError||(this.originalConsoleError=console.error,console.error=(...t)=>{var e;let s;if(null===(e=this.originalConsoleError)||void 0===e||e.apply(console,t),t[0]instanceof Error)s=t[0];else{const e=t.map(t=>"object"==typeof t?JSON.stringify(t):String(t)).join(" ");s=new Error(e),s.name="ConsoleError"}this.onError(s,{type:"console",reason:t})})}disableConsoleErrors(){this.originalConsoleError&&(console.error=this.originalConsoleError,this.originalConsoleError=null)}ignoreErrors(t){this.ignoredErrors=[...this.ignoredErrors,...t]}shouldIgnoreError(t){if(!this.ignoredErrors.length)return!1;const e=`${t.name}: ${t.message}`;return this.ignoredErrors.some(s=>e.includes(s)||t.stack&&t.stack.includes(s))}handleWindowError(t){if(t.filename&&!t.filename.startsWith(window.location.origin))return;let e;t.error?e=t.error:(e=new Error(t.message),e.name="WindowError",e.stack=`at ${t.filename}:${t.lineno}:${t.colno}`),e.fingerprint=f(e),this.shouldIgnoreError(e)||this.onError(e,{type:"window",event:t})}handleUnhandledRejection(t){let e;if(t.reason instanceof Error)e=t.reason;else{const s="string"==typeof t.reason?t.reason:JSON.stringify(t.reason);e=new Error(`Unhandled Promise Rejection: ${s}`),e.name="UnhandledRejection"}e.fingerprint=f(e),this.shouldIgnoreError(e)||this.onError(e,{type:"promise",reason:t.reason})}captureError(t,e){const s=new Error(t.message);s.name=t.name,s.stack=t.stack,s.fingerprint=f(t),s.customMetadata=e,this.onError(s,{type:"window",event:void 0})}isActive(){return this.isCapturing}getIgnoredErrors(){return[...this.ignoredErrors]}clearIgnoredErrors(){this.ignoredErrors=[]}}class v{constructor(t){this.isMonitoring=!1,this.trackSuccessfulRequests=!1,this.trackTimeout=1e4,this.ignoredUrls=[],this.onError=t,this.originalFetch=window.fetch,this.originalXMLHttpRequest=window.XMLHttpRequest,this.originalXHRPrototype=XMLHttpRequest.prototype}start(){this.isMonitoring||(this.patchFetch(),this.patchXMLHttpRequest(),this.isMonitoring=!0)}stop(){this.isMonitoring&&(window.fetch=this.originalFetch,window.XMLHttpRequest=this.originalXMLHttpRequest,this.isMonitoring=!1)}configure(t){void 0!==t.trackSuccessfulRequests&&(this.trackSuccessfulRequests=t.trackSuccessfulRequests),void 0!==t.trackTimeout&&(this.trackTimeout=t.trackTimeout),void 0!==t.ignoredUrls&&(this.ignoredUrls=t.ignoredUrls)}shouldIgnoreUrl(t){return this.ignoredUrls.some(e=>e.test(t))}patchFetch(){const t=this;window.fetch=function(...e){return s=this,n=void 0,r=function*(){const s=performance.now(),n=e[0],i=e[1]||{};let r,o="GET",a=null;if("string"==typeof n?r=n:n instanceof Request?(r=n.url,o=n.method):r=String(n),t.shouldIgnoreUrl(r))return t.originalFetch.apply(window,e);i.body&&(a=i.body),o=i.method||o;try{const n=yield t.originalFetch.apply(window,e),i=performance.now()-s;if(!n.ok){let e=null;try{const t=n.clone(),s=n.headers.get("content-type");e=s&&s.includes("application/json")?yield t.json():yield t.text()}catch(t){}t.onError({type:"fetch",url:r,method:o,status:n.status,statusText:n.statusText,duration:i,responseBody:e})}return t.trackSuccessfulRequests&&i>t.trackTimeout&&t.onError({type:"fetch",url:r,method:o,status:n.status,statusText:"Timeout",duration:i,error:new Error(`Request took ${i.toFixed(0)}ms`)}),n}catch(e){const n=performance.now()-s;throw t.onError({type:"fetch",url:r,method:o,status:0,statusText:"Network Error",duration:n,error:e,requestBody:a}),e}},new((i=void 0)||(i=Promise))(function(t,e){function o(t){try{l(r.next(t))}catch(t){e(t)}}function a(t){try{l(r.throw(t))}catch(t){e(t)}}function l(e){var s;e.done?t(e.value):(s=e.value,s instanceof i?s:new i(function(t){t(s)})).then(o,a)}l((r=r.apply(s,n||[])).next())});var s,n,i,r}}patchXMLHttpRequest(){const t=this,e=this.originalXMLHttpRequest;window.XMLHttpRequest=class extends e{constructor(){super(...arguments),this._url="",this._method="GET",this._startTime=0,this._requestBody=null,this._responseBody=null}open(e,s,...n){this._method=e,this._url=s.toString(),this._startTime=performance.now(),t.shouldIgnoreUrl(this._url)||(this.addEventListener("error",this.handleError.bind(this)),this.addEventListener("load",this.handleLoad.bind(this)),this.addEventListener("timeout",this.handleTimeout.bind(this)),this.addEventListener("abort",this.handleAbort.bind(this))),super.open.apply(this,[e,s,...n])}send(t){this._requestBody=t,super.send(t)}handleError(){const e=performance.now()-this._startTime;t.onError({type:"xhr",url:this._url,method:this._method,status:this.status,statusText:this.statusText,duration:e,error:new Error("XHR Network Error"),requestBody:this._requestBody,responseBody:this._responseBody})}handleLoad(){const e=performance.now()-this._startTime;if(this.status>=400){try{""===this.responseType||"text"===this.responseType?this._responseBody=this.responseText:"json"===this.responseType&&(this._responseBody=this.response)}catch(t){}t.onError({type:"xhr",url:this._url,method:this._method,status:this.status,statusText:this.statusText,duration:e,requestBody:this._requestBody,responseBody:this._responseBody})}t.trackSuccessfulRequests&&e>t.trackTimeout&&t.onError({type:"xhr",url:this._url,method:this._method,status:this.status,statusText:"Timeout",duration:e,error:new Error(`Request took ${e.toFixed(0)}ms`)})}handleTimeout(){const e=performance.now()-this._startTime;t.onError({type:"xhr",url:this._url,method:this._method,status:408,statusText:"Request Timeout",duration:e,error:new Error("XHR Request Timeout"),requestBody:this._requestBody})}handleAbort(){const e=performance.now()-this._startTime;t.onError({type:"xhr",url:this._url,method:this._method,status:0,statusText:"Request Aborted",duration:e,error:new Error("XHR Request Aborted"),requestBody:this._requestBody})}}}isActive(){return this.isMonitoring}getConfig(){return{trackSuccessfulRequests:this.trackSuccessfulRequests,trackTimeout:this.trackTimeout,ignoredUrls:this.ignoredUrls}}}function b(t){var e;if(!t||!t.ownerDocument)return"";if(t.id)return`//*[@id="${t.id}"]`;const s=[];let n=t;for(;n&&n.nodeType===Node.ELEMENT_NODE;){let t=0;const i=(null===(e=n.parentNode)||void 0===e?void 0:e.children)||[];for(let e=0;e<i.length;e++){const r=i[e];if(r===n){const e=n.tagName.toLowerCase();s.unshift(`${e}[${t+1}]`);break}r.tagName===n.tagName&&t++}n=n.parentElement}return s.length>0?`/${s.join("/")}`:""}function y(t,e=200){var s;if(!t)return"";const n=(null===(s=t.textContent)||void 0===s?void 0:s.trim())||"";return n.length<=e?n:n.substring(0,e)+"..."}function w(t){if(["A","BUTTON","INPUT","SELECT","TEXTAREA","LABEL"].includes(t.tagName))return!0;const e=t.getAttribute("role");return!(!e||!["button","link","menuitem","tab","checkbox","radio"].includes(e))||!!(t.hasAttribute("onclick")||t.hasAttribute("onchange")||t.hasAttribute("onsubmit"))||!!(t.hasAttribute("data-track")||t.hasAttribute("data-testid")||t.hasAttribute("data-qa"))}function S(t,e){let s=0,n=null;return function(...i){const r=Date.now(),o=e-(r-s);o<=0?(s=r,t.apply(this,i)):n||(n=window.setTimeout(()=>{s=Date.now(),t.apply(this,i),n=null},o))}}class E{constructor(t){this.isTracking=!1,this.ignoredActions=[],this.trackedElements=new Set,this.throttleDelay=100,this.onAction=t}start(){if(this.isTracking)return;const t=S(this.handleClick.bind(this),this.throttleDelay),e=S(this.handleSubmit.bind(this),this.throttleDelay),s=S(this.handleChange.bind(this),this.throttleDelay),n=S(this.handleKeydown.bind(this),this.throttleDelay);document.addEventListener("click",t,{capture:!0,passive:!0}),document.addEventListener("submit",e,{capture:!0}),document.addEventListener("change",s,{capture:!0}),document.addEventListener("keydown",n,{capture:!0}),this.trackNavigation(),this.isTracking=!0}stop(){this.isTracking&&(document.removeEventListener("click",this.handleClick),document.removeEventListener("submit",this.handleSubmit),document.removeEventListener("change",this.handleChange),document.removeEventListener("keydown",this.handleKeydown),this.isTracking=!1)}configure(t){t.ignoredActions&&(this.ignoredActions=t.ignoredActions),void 0!==t.throttleDelay&&(this.throttleDelay=t.throttleDelay)}shouldIgnoreAction(t,e){if(this.ignoredActions.includes(e))return!0;if(t.hasAttribute("data-bt-ignore"))return!0;const s=t.tagName.toLowerCase();return!!["script","style","link","meta"].includes(s)||"html"===s||"body"===s}handleClick(t){const e=t.target;if(!e)return;const s=function(t){let e=t;for(;e;){if(w(e))return e;e=e.parentElement}return null}(e)||e;if(this.shouldIgnoreAction(s,"click"))return;const n=`${s.tagName}-${s.id||s.className}`;this.trackedElements.has(n)||(this.trackedElements.add(n),setTimeout(()=>this.trackedElements.delete(n),1e3),this.onAction({type:"click",element:s,target:e,event:t,metadata:{xPath:b(s),text:y(s,100),tagName:s.tagName,id:s.id||void 0,className:s.className||void 0,href:s.href||void 0,coordinates:{x:t.clientX,y:t.clientY},url:window.location.href}}))}handleSubmit(t){const e=t.target;e&&(this.shouldIgnoreAction(e,"submit")||this.onAction({type:"submit",element:e,target:e,event:t,metadata:{xPath:b(e),text:y(e,100),tagName:e.tagName,id:e.id||void 0,className:e.className||void 0,action:e.action,method:e.method,url:window.location.href}}))}handleChange(t){const e=t.target;if(!e)return;const s=e.type;["text","email","password","search","tel","url","number"].includes(s)&&(this.shouldIgnoreAction(e,"change")||this.onAction({type:"change",element:e,target:e,value:e.value,event:t,metadata:{xPath:b(e),text:y(e,50),tagName:e.tagName,id:e.id||void 0,className:e.className||void 0,type:s,name:e.name||void 0,value:e.value.substring(0,100),url:window.location.href}}))}handleKeydown(t){if(!["Enter","Escape","Tab"].includes(t.key))return;const e=t.target;e&&(this.shouldIgnoreAction(e,"keydown")||this.onAction({type:"keydown",element:e,target:e,event:t,metadata:{xPath:b(e),text:y(e,50),tagName:e.tagName,id:e.id||void 0,className:e.className||void 0,key:t.key,code:t.code,url:window.location.href}}))}trackNavigation(){const t=history.pushState,e=history.replaceState,s=t=>{this.onAction({type:"navigation",element:document.body,target:document.body,event:new Event(t),metadata:{xPath:"/html/body",text:"",tagName:"BODY",url:window.location.href,navigationType:t,referrer:document.referrer}})};history.pushState=function(...e){t.apply(this,e),s("pushstate")},history.replaceState=function(...t){e.apply(this,t),s("replacestate")},window.addEventListener("popstate",()=>{this.onAction({type:"navigation",element:document.body,target:document.body,event:new Event("popstate"),metadata:{xPath:"/html/body",text:"",tagName:"BODY",url:window.location.href,navigationType:"popstate",referrer:document.referrer}})})}trackManualAction(t,e,s){this.onAction({type:t,element:e,target:e,event:new Event("manual"),metadata:Object.assign({xPath:b(e),text:y(e,100),tagName:e.tagName,id:e.id||void 0,className:e.className||void 0,url:window.location.href},s)})}isActive(){return this.isTracking}getConfig(){return{ignoredActions:this.ignoredActions,throttleDelay:this.throttleDelay}}}class k{constructor(t="bottom-right",e,s="Report Bug"){this.button=null,this.isVisible=!0,this.position=t,this.onClick=e,this.text=s,this.styles={base:{position:"fixed",zIndex:"2147483647",padding:"12px 24px",backgroundColor:"#e74c3c",color:"white",border:"none",borderRadius:"25px",cursor:"pointer",fontSize:"14px",fontWeight:"600",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",outline:"none",userSelect:"none",touchAction:"manipulation",backdropFilter:"blur(10px)",borderWidth:"1px",borderStyle:"solid",borderColor:"rgba(255, 255, 255, 0.2)"},hover:{backgroundColor:"#c0392b",transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(0, 0, 0, 0.2)"},active:{backgroundColor:"#a93226",transform:"translateY(0)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"}}}create(){if(!this.button){if(this.button=document.createElement("button"),this.button.id="bugtracker-widget-button",this.button.innerHTML=this.text,this.button.title="Report a bug or issue",this.button.setAttribute("aria-label","Report a bug"),this.button.setAttribute("role","button"),this.applyStyles(this.styles.base),this.applyPosition(),this.addEventListeners(),!document.body){const t=()=>{try{document.body.appendChild(this.button),this.addGlobalStyles()}catch(t){console.error("WidgetButton: failed to append button after DOMContentLoaded",t),this.button=null}};return void("loading"===document.readyState?document.addEventListener("DOMContentLoaded",t,{once:!0}):setTimeout(t,0))}document.body.appendChild(this.button),this.addGlobalStyles()}}applyStyles(t){this.button&&Object.assign(this.button.style,t)}applyPosition(){this.button&&Object.assign(this.button.style,{"top-left":{top:"20px",left:"20px"},"top-right":{top:"20px",right:"20px"},"bottom-left":{bottom:"20px",left:"20px"},"bottom-right":{bottom:"20px",right:"20px"}}[this.position])}addEventListeners(){this.button&&(this.button.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),this.onClick()}),this.button.addEventListener("mouseenter",()=>{this.applyStyles(this.styles.hover)}),this.button.addEventListener("mouseleave",()=>{this.applyStyles(this.styles.base)}),this.button.addEventListener("mousedown",()=>{this.applyStyles(this.styles.active)}),this.button.addEventListener("mouseup",()=>{this.applyStyles(this.styles.hover)}),this.button.addEventListener("touchstart",()=>{this.applyStyles(this.styles.active)},{passive:!0}),this.button.addEventListener("touchend",()=>{this.applyStyles(this.styles.base)},{passive:!0}),this.button.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.onClick())}))}addGlobalStyles(){const t="bugtracker-widget-styles";if(document.getElementById(t))return;const e=document.createElement("style");e.id=t,e.textContent="\n            #bugtracker-widget-button {\n                animation: bugtracker-button-appear 0.3s ease;\n            }\n            @keyframes bugtracker-button-appear {\n                from { opacity: 0; transform: translateY(20px) scale(0.9); }\n                to { opacity: 1; transform: translateY(0) scale(1); }\n            }\n            @media (prefers-reduced-motion: reduce) {\n                #bugtracker-widget-button { animation: none; transition: none; }\n            }\n        ";const s=document.head||document.documentElement||document.body;try{s.appendChild(e)}catch(t){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{(document.head||document.documentElement||document.body).appendChild(e)},{once:!0}):console.error("WidgetButton: failed to append global styles",t)}}show(){this.button&&(this.button.style.display="block",this.button.style.visibility="visible",this.button.style.opacity="1",this.isVisible=!0)}hide(){this.button&&(this.button.style.display="none",this.isVisible=!1)}toggle(){this.isVisible?this.hide():this.show()}setText(t){this.text=t,this.button&&(this.button.innerHTML=t)}setPosition(t){this.position=t,this.button&&this.applyPosition()}updateStyles(t){t.base&&(this.styles.base=Object.assign(Object.assign({},this.styles.base),t.base)),t.hover&&(this.styles.hover=Object.assign(Object.assign({},this.styles.hover),t.hover)),t.active&&(this.styles.active=Object.assign(Object.assign({},this.styles.active),t.active)),this.button&&this.applyStyles(this.styles.base)}destroy(){if(!this.button)return;this.button.parentNode&&this.button.parentNode.removeChild(this.button);const t=document.getElementById("bugtracker-widget-styles");t&&t.parentNode&&t.parentNode.removeChild(t),this.button=null}exists(){return null!==this.button}isButtonVisible(){return this.isVisible}getButtonElement(){return this.button}}var T=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};class N{constructor(t){if(this.networkMonitor=null,this.userActionTracker=null,this.flushTimer=null,this.isInitialized=!1,void 0===t.projectId||null===t.projectId)throw new Error("projectId is required");if(!t.apiUrl)throw new Error("apiUrl is required");if(this.config=Object.assign({maxBufferSize:50,flushInterval:5e3,captureUserActions:!0,captureNetworkErrors:!0,buttonPosition:"bottom-right",sessionTimeout:18e5,debug:!1},t),this.client=new u(this.config.apiUrl,this.config.projectId),this.sessionManager=new g(this.config.sessionTimeout,this.client),void 0!==this.config.sessionId&&null!==this.config.sessionId){const t=Number(this.config.sessionId);Number.isNaN(t)||this.sessionManager.setServerSessionId(t)}this.eventBuffer=new m(this.config.maxBufferSize,this.flushEvents.bind(this)),this.errorCatcher=new p((t,e)=>this.trackJSError(t,e)),this.config.captureNetworkErrors&&(this.networkMonitor=new v(t=>this.trackNetworkError(t))),this.config.captureUserActions&&(this.userActionTracker=new E(t=>this.trackUserAction(t))),this.widgetButton=new k(this.config.buttonPosition,()=>this.openBugReport())}initialize(){return T(this,void 0,void 0,function*(){var t,e;if(!this.isInitialized)try{let s,n;this.config.debug&&console.log("[BugTracker] initializing session...");try{s=this.sessionManager.initialize(),n=this.sessionManager.getSessionData(),this.config.debug&&console.log("[BugTracker] session initialized:",s)}catch(t){throw console.error("[BugTracker] SessionManager.initialize() failed:",t),new Error(`Session initialization failed: ${t instanceof Error?t.message:String(t)}`)}this.config.debug&&console.log("[BugTracker] starting trackers...");try{this.errorCatcher.start(),null===(t=this.networkMonitor)||void 0===t||t.start(),null===(e=this.userActionTracker)||void 0===e||e.start(),this.config.debug&&console.log("[BugTracker] trackers started")}catch(t){throw console.error("[BugTracker] Starting trackers failed:",t),new Error(`Starting trackers failed: ${t instanceof Error?t.message:String(t)}`)}this.config.debug&&console.log("[BugTracker] creating widget button...");try{this.widgetButton.create(),this.config.debug&&console.log("[BugTracker] widget button created")}catch(t){throw console.error("[BugTracker] WidgetButton.create() failed:",t),new Error(`Widget creation failed: ${t instanceof Error?t.message:String(t)}`)}this.config.debug&&console.log("[BugTracker] starting flush timer...");try{this.startFlushTimer(),this.config.debug&&console.log("[BugTracker] flush timer started (if configured)")}catch(t){throw console.error("[BugTracker] startFlushTimer() failed:",t),new Error(`startFlushTimer failed: ${t instanceof Error?t.message:String(t)}`)}this.config.debug&&console.log("[BugTracker] setting up unload handler...");try{this.setupPageUnloadHandler(),this.config.debug&&console.log("[BugTracker] unload handler set")}catch(t){throw console.error("[BugTracker] setupPageUnloadHandler() failed:",t),new Error(`setupPageUnloadHandler failed: ${t instanceof Error?t.message:String(t)}`)}this.isInitialized=!0,this.config.debug&&console.log("BugTracker initialized")}catch(t){throw console.error("BugTracker initialization failed:",t),t}})}trackJSError(t,e){const s=null==e?void 0:e.event,n={type:"ERROR",name:t.name,message:t.message,stackTrace:t.stack,timestamp:(new Date).toISOString(),url:window.location.href,lineNumber:null==s?void 0:s.lineno,columnNumber:null==s?void 0:s.colno,fileName:null==s?void 0:s.filename,customMetadata:{errorType:"JS_ERROR",errorSource:null==e?void 0:e.type}};this.addEvent(n)}trackNetworkError(t){const e={type:"NETWORK",name:`Network ${t.status}`,message:t.error?t.error.message:void 0,timestamp:(new Date).toISOString(),url:window.location.href,networkUrl:t.url,statusCode:t.status,duration:t.duration,customMetadata:Object.assign({method:t.method},t.error&&{errorName:t.error.name,errorStack:t.error.stack,statusText:t.statusText})};this.addEvent(e)}trackUserAction(t){var e,s;const n=t.element,i={};try{n instanceof HTMLAnchorElement&&(i.href=n.href,n.target&&(i.target=n.target)),n instanceof HTMLFormElement&&(i.action=n.action,i.method=n.method),(n instanceof HTMLInputElement||n instanceof HTMLTextAreaElement||n instanceof HTMLSelectElement)&&(i.inputName=n.name||void 0,i.inputType=n.type||void 0,i.value=(null!==(e=n.value)&&void 0!==e?e:"").toString().substring(0,100)),n.dataset&&Object.keys(n.dataset).length>0&&(i.dataset=Object.assign({},n.dataset))}catch(t){console.debug("[BugTracker] Failed to extract element attributes for action metadata:",t)}const r={type:"ACTION",name:`User ${t.type}`,timestamp:(new Date).toISOString(),url:window.location.href,tagName:n.tagName,xPath:this.getElementXPath(n),customMetadata:Object.assign({elementId:n.id||void 0,elementClass:n.className||void 0,textContent:null===(s=n.textContent)||void 0===s?void 0:s.substring(0,100),eventType:t.event.type},i)};this.addEvent(r)}trackEvent(t,e){const s={type:"CUSTOM",name:t,timestamp:(new Date).toISOString(),url:window.location.href,customMetadata:e};this.addEvent(s)}captureError(t,e){const s={type:"ERROR",name:t.name,message:t.message,stackTrace:t.stack,timestamp:(new Date).toISOString(),url:window.location.href,customMetadata:Object.assign(Object.assign({},e),{capturedManually:!0})};this.addEvent(s)}addEvent(t){this.eventBuffer.add(t)}flushEvents(t){return T(this,void 0,void 0,function*(){if(0!==t.length)try{const e=yield this.client.sendEvents(t,this.sessionManager.getSessionId(),this.sessionManager.getSessionData());this.config.debug&&console.log(`Flushed ${t.length} events:`,e)}catch(t){throw console.error("Failed to flush events:",t),t}})}openBugReport(){return T(this,void 0,void 0,function*(){let t;try{t=yield o.e(335).then(o.bind(o,335))}catch(t){console.error("[BugTracker] Failed to load BugReportModal chunk:",t);try{this.trackEvent("BugReportModalLoadFailed",{error:t instanceof Error?t.message:String(t)})}catch(t){console.debug("[BugTracker] Failed to track BugReportModalLoadFailed:",t)}return}const{BugReportModal:e}=t,s=new e(t=>T(this,void 0,void 0,function*(){var e;yield this.eventBuffer.flush();const s=Object.assign(Object.assign({},t),{screenshot:null!==(e=t.screenshot)&&void 0!==e?e:""});yield this.client.sendBugReport(s,this.sessionManager.getSessionId(),this.sessionManager.getSessionData()),this.trackEvent("BugReportSubmitted",{hasScreenshot:!!t.screenshot,commentLength:t.comment.length});try{yield this.eventBuffer.flush()}catch(t){console.error("[BugTracker] Failed to flush events after BugReportSubmitted:",t)}try{this.config.debug&&console.log("[BugTracker] ending current session after report..."),this.sessionManager.endSession()}catch(t){console.error("[BugTracker] Failed to end session after report:",t)}try{this.config.debug&&console.log("[BugTracker] creating new session after report...");const t=this.sessionManager.initialize();this.config.debug&&console.log("[BugTracker] new session id:",t)}catch(t){console.error("[BugTracker] Failed to create a new session after report:",t)}this.config.debug&&console.log("Bug report sent successfully")}),()=>{});yield s.open()})}startFlushTimer(){this.flushTimer&&clearInterval(this.flushTimer),this.config.flushInterval&&this.config.flushInterval>0&&(this.flushTimer=window.setInterval(()=>{this.eventBuffer.flush()},this.config.flushInterval)),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.eventBuffer.hasUrgentEvents()&&this.eventBuffer.flush().catch(()=>{})})}setupPageUnloadHandler(){window.addEventListener("beforeunload",()=>{const t=this.eventBuffer.getEvents();this.eventBuffer.hasUrgentEvents()&&t.length>0&&this.client.sendEventsWithBeacon(t,this.sessionManager.getSessionId(),this.sessionManager.getSessionData())})}getElementXPath(t){var e;if(t.id)return`//*[@id="${t.id}"]`;const s=[];let n=t;for(;n&&n.nodeType===Node.ELEMENT_NODE;){let t=0;const i=(null===(e=n.parentNode)||void 0===e?void 0:e.children)||[];for(let e=0;e<i.length;e++){if(i[e]===n){s.unshift(`${n.tagName.toLowerCase()}[${t+1}]`);break}i[e].tagName===n.tagName&&t++}n=n.parentElement}return s.length?"/"+s.join("/"):""}destroy(){var t,e;this.flushTimer&&(clearInterval(this.flushTimer),this.flushTimer=null),this.errorCatcher.stop(),null===(t=this.networkMonitor)||void 0===t||t.stop(),null===(e=this.userActionTracker)||void 0===e||e.stop(),this.widgetButton.destroy(),window.removeEventListener("beforeunload",this.eventBuffer.flush),document.removeEventListener("visibilitychange",this.eventBuffer.flush),this.isInitialized=!1}getSessionId(){return this.sessionManager.getSessionId()}flush(){return T(this,void 0,void 0,function*(){yield this.eventBuffer.flush()})}waitForServerSession(){return T(this,arguments,void 0,function*(t=5e3){const e=Date.now();return new Promise(s=>{const n=()=>{this.sessionManager.isServerBacked()?s(this.sessionManager.getSessionId()):Date.now()-e>=t?s(null):setTimeout(n,200)};n()})})}ensureServerSession(){return T(this,void 0,void 0,function*(){if(!this.client)return null;try{const t=this.sessionManager.getSessionId(),e=this.sessionManager.getSessionData();console.debug("[BugTracker] ensureServerSession: sending POST to /api/sessions for local id",t);const s=yield this.client.sendSessionStart(String(t),e);return null===s||Number.isNaN(Number(s))?(console.debug("[BugTracker] ensureServerSession: server did not return a session id"),null):(this.sessionManager.setServerSessionId(Number(s)),console.debug("[BugTracker] ensureServerSession: server session created",s),Number(s))}catch(t){return console.error("[BugTracker] ensureServerSession failed:",t),null}})}}var I=function(t,e,s,n){return new(s||(s=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(o,a)}l((n=n.apply(t,e||[])).next())})};let x=null,B=null,A=null;const C=()=>{if(!x&&!B)throw new Error("BugTracker not initialized. Call BugTracker.initialize(projectId, opts) first.")},O={initialize(t,e){return I(this,void 0,void 0,function*(){var s;if(A)return A;if(B)return Promise.resolve(O);const n=null!==(s=null==e?void 0:e.baseUrl)&&void 0!==s?s:window.location.origin;x=new u(n,String(t));try{B=new N({projectId:String(t),apiUrl:n,debug:!!(null==e?void 0:e.debug)})}catch(t){throw console.error("[BugTracker] Failed to construct tracker:",t),t}return A=B.initialize().then(()=>O).catch(t=>{throw console.error("[BugTracker] initialization failed:",t),A=null,t}),A})},sendEvents(t,e,s){return I(this,void 0,void 0,function*(){if(C(),x)return x.sendEvents(t,e,s);throw new Error("Client not available")})},sendEventsWithBeacon:(t,e,s)=>(C(),!!x&&x.sendEventsWithBeacon(t,e,s)),sendBugReport(t,e,s){return I(this,void 0,void 0,function*(){if(C(),x)return x.sendBugReport(t,e,s);throw new Error("Client not available")})},isInitialized:()=>null!==x||null!==B};if("undefined"!=typeof window)try{window.BugTracker=O}catch(t){console.debug("[BugTracker] Could not attach global BugTracker:",t)}const M=O.initialize,R=O.sendEvents,L=O.sendEventsWithBeacon,j=O.sendBugReport,D=O.isInitialized,P=O,_=O;return l})());